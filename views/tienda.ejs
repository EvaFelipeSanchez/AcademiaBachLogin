<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AcademiaBach</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <style>
      .sidebaror {
        position: relative;
          transition: 0.3s;
          display: flex;
          flex-direction: column;
          
      }

      .sidebaror img {
            width: 85%;
            height: auto;
            margin-top: 2.5%;
            }

     .sidebar {
          height: 150%;
          width: 9%;
          position: fixed;
          top: 0;
          left: -150%; 
          background-color: #acc1e5;
          transition: 0.3s;

      }

      .sidebar a {
          padding: 7%;
          text-decoration: none;
          font-size: 1vw;
          color: #1c4b6a;
          display: block;
      }

      .sidebar img {
      width: 100%;
      height: auto;

      }

      .sidebar a:hover {
          background-color: #acc1e5;
      }


      .content {
          margin-left: 5%;
          padding: 7%;
      }

      .content a img {
        position: fixed;
        left: 1%;
        top: 1%;
        width: 7%;
        height: auto;
        z-index: 3;
        }

        body {
        background-image: url('/images/Fondo3.png');  
        background-size: cover;               

        margin: 0;
        padding: 0;
        overflow: hidden; 
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        }

        main {
        display: flex;
        flex-direction: column;
        }

        header{
            background-color: rgb(31, 39, 78);
            color: white;
            text-align: center;
            padding: 0.5%;
        
        }

        footer {
            background-color: rgb(31, 39, 78);
            color: white;
            text-align: center;
            padding: 0.5%;
            margin-top: auto;
        }
            
            
        .header-container {
            display: flex;
            align-items: center;
            justify-content: space-between; 
        }


        .count {
            height: 0;
           width: 10%;          
            display: flex;
            justify-content: center;
            align-items: center;
            top: 50%; /* Centrar verticalmente en todos los dispositivos */
            left: 50%; /* Centrar horizontalmente en todos los dispositivos */
            transform: translate(-50%, -50%); /* Centrar en la mitad de la pantalla */
            color: rgb(31, 39, 78);
                font-family: 'Arial', sans-serif; 
        }

        .store {
            position: fixed;
            top: 20%;
            left: 15%; 
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            transform: translate(-10%, 5%);
            overflow-y: auto; 
            max-height: 70vh;
        }

        .item {
            background-color: #acc1e5;
            border: 1px solid #1b184f;
            text-align: center;
        }



        .store img {
            max-width: 50%;
        }

        .price {
            font-size: 1.2vw;

        }

        .buy-button {
            background-color: #213953;
            color: #fff;
            padding: 1% 5%;
            border: none;
            cursor: pointer;
        }

        .mascotabar{
            width: 7%;
            background-color: #acc1e5;
            border: 1px solid #1b184f;
            padding: 0%;

            left: 78%;
            top: 7%;
            position: fixed;
            display: flex;
            justify-content: center;
            align-items: center;

            color: rgb(31, 39, 78);

        }

        .mascotabar img {
            width: 100%;
            height: auto;
        }



       
        .punto {
        font-size: 2.1vw;
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
             
        font-family: 'Arial', sans-serif;
        background-color: rgb(31, 39, 78);
        color: #fff;
        z-index: -5;
        position: fixed;

        left: 62%;
        top: 10%;
        
        }


        .punto .contenido {
        flex: 1; 
        }

        .cerrar {
             position: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            top: 13%; 
            left: 91%; 
            transform: translate(-50%, -50%); 
            color: rgb(31, 39, 78);

        }

        .cerrar img {
            max-width: 61%;
            height: auto;
        }
        .nombreUsuario1 {
            font-size: 1.3vw;
            text-align: right;
            color: rgb(255, 255, 255);
            font-family: 'Arial', sans-serif; 
            background-color: rgb(31, 39, 78);
            z-index: 10;
            margin: 0;
        }

        @media screen and (max-width: 600px) {
            
            .sidebaror {
                position: relative;
                transition: 0.3s;
                display: flex;
                flex-direction: row; 

            }

            .sidebar {
                height: 10%; 
                width: 90%; 
                position: fixed;
                top: 5.5%;
                left: -150%;
                background-color: #acc1e5;
                transition: 0.3s;
                display: flex; 
                flex-direction: row; 
                align-items: center; 
                font-size: 150%;

            }

            .sidebar a {
                padding: 1%; 
                text-decoration: none;
                font-size: 1vw;
                color: #1c4b6a;
                display: inline-block; 
            }

            .sidebar img {
                width: 50%;
                margin-left: 0;
            }

            .sidebar a:hover {
                background-color: #acc1e5;
            }

            .content a img {
                position: fixed;
                left: 1%;
                top: 4%;
                width: 10%;
                height: auto;
                z-index: 3;
            }

            header{
            background-color: rgb(31, 39, 78);
            color: white;
            text-align: center;
            padding: 2%;

            }

            footer {
            background-color: rgb(31, 39, 78);
            color: white;
            text-align: center;
            padding: 2%;
            margin-top: auto;
            }

 
            .nombreUsuario1 {
            font-size: 2.3vw;
            text-align: right;
            color: rgb(255, 255, 255);
            font-family: 'Arial', sans-serif; 
            background-color: rgb(31, 39, 78);
            z-index: 10;
            margin: 0;
            }

 

            .cerrar {
            position: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            top: 23%; 
            left: 90%; 
            transform: translate(-50%, -50%); 
            color: rgb(31, 39, 78);

            }

            .cerrar img {
            max-width: 115%;
            height: auto;
            }

            .count {
            height: 0;
            width: 10%;          
            display: flex;
            justify-content: center;
            align-items: center;
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%);
            color: rgb(31, 39, 78);
                font-family: 'Arial', sans-serif; 
            }

            .store {
            position: fixed;
            top: 27%;
            left: 20%; 
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            transform: translate(-10%, 5%);
            overflow-y: auto; 
            max-height: 63vh;
             width: 45vh;
            }

            .item {
            background-color: #acc1e5;
            border: 1px solid #1b184f;
            text-align: center;
            width: 50%;
             height: auto;
            }


            .store img {
            max-width: 50%;
            }

            .price {
            font-size: 3.5vw;

            }

            .buy-button {
                background-color: #213953;
                color: #fff;
                padding: 1% 5%;
                border: none;
                cursor: pointer;
            }

            .mascotabar{
                width: 12%;
                background-color: #acc1e5;
                border: 1px solid #1b184f;
                padding: 0%;

                left: 68%;
                top: 18%;
                position: fixed;
                display: flex;
                justify-content: center;
                align-items: center;

                color: rgb(31, 39, 78);

            }

            .mascotabar img {
                width: 100%;
                height: auto;
            }


            .punto {
            font-size: 3.5vw;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            
            font-family: 'Arial', sans-serif;
            background-color: rgb(31, 39, 78);
            color: #fff;
            z-index: -5;
            position: fixed;

            left: 40%;
            top: 19%;

            }

            .punto .contenido {
            flex: 1; 
            }

            .item .nuevaMascotaInput{
                width: 75%;
                height: auto;
            }


        }



            @media screen and (min-width: 601px) and (max-width: 1024px) {
            .sidebaror {
                position: relative;
                transition: 0.3s;
                display: flex;
                flex-direction: column;
                
            }

            .sidebaror img {
                    width: 95%;
                    height: auto;
                    margin-top: 2.5%;
                    }

            .sidebar {
                height: 150%;
                width: 13%;
                position: fixed;
                top: 0;
                left: -150%; 
                background-color: #acc1e5;
                transition: 0.3s;

            }

            .sidebar a {
                padding: 7%;
                text-decoration: none;
                font-size: 1vw;
                color: #1c4b6a;
                display: block;
            }

            .sidebar img {
            width: 110%;
            height: auto;

            }

            .sidebar a:hover {
                background-color: #acc1e5;
            }


            .content {
                margin-left: 5%;
                padding: 7%;
            }

            .content a img {
                position: fixed;
                left: 1%;
                top: 2%;
                width: 10%;
                height: auto;
                z-index: 3;
                }

                body {
                background-image: url('/images/Fondo3.png');  
                background-size: cover;               

                margin: 0;
                padding: 0;
                overflow: hidden; 
                display: flex;
                flex-direction: column;
                min-height: 100vh;
                }

                main {
                display: flex;
                flex-direction: column;
                }

                header{
                    background-color: rgb(31, 39, 78);
                    color: white;
                    text-align: center;
                    padding: 0.5%;
                
                }

                footer {
                    background-color: rgb(31, 39, 78);
                    color: white;
                    text-align: center;
                    padding: 0.5%;
                    margin-top: auto;
                }
                    
                    
                .header-container {
                    display: flex;
                    align-items: center;
                    justify-content: space-between; 
                }

            .nombreUsuario1 {
                font-size: 1.9vw;
                text-align: right;
                color: rgb(255, 255, 255);
                font-family: 'Arial', sans-serif; 
                background-color: rgb(31, 39, 78);
                z-index: 10;
                margin: 0;
            }

 
            .cerrar {
                position: fixed;
                display: flex;
                justify-content: center;
                align-items: center;
                top: 19%; 
                left: 87%; 
                transform: translate(-50%, -50%); 
                color: rgb(31, 39, 78);

            }

            .cerrar img {
                max-width: 75%;
                height: auto;
            }

            .count {
            height: 0;
            width: 10%;          
            display: flex;
            justify-content: center;
            align-items: center;
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%);
            color: rgb(31, 39, 78);
                font-family: 'Arial', sans-serif; 
            }

            .store {
            position: fixed;
            top: 23.5%;
            left: 29%; 
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            transform: translate(-10%, 5%);
            overflow-y: auto; 
            max-height: 68vh;
            width: 85vh;
            }

            .item {
            background-color: #acc1e5;
            border: 1px solid #1b184f;
            text-align: center;
            width: 50%;
             height: auto;
            }


            .store img {
            max-width: 35%;
            }

            .price {
            font-size: 2vw;

            }

            .buy-button {
                background-color: #213953;
                color: #fff;
                padding: 1% 5%;
                border: none;
                cursor: pointer;
            }

            .mascotabar{
                width: 8%;
                background-color: #acc1e5;
                border: 1px solid #1b184f;
                padding: 0%;

                left: 68%;
                top: 12%;
                position: fixed;
                display: flex;
                justify-content: center;
                align-items: center;

                color: rgb(31, 39, 78);

            }

            .mascotabar img {
                width: 100%;
                height: auto;
            }


            .punto {
            font-size: 2.5vw;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            
            font-family: 'Arial', sans-serif;
            background-color: rgb(31, 39, 78);
            color: #fff;
            z-index: -5;
            position: fixed;

            left: 47%;
            top: 14%;

            }

            .punto .contenido {
            flex: 1; 
            }


            }
  </style>
  </head>




      
  <header>
    <p class="nombreUsuario1">   Usuario conectado: <%= user.name %>  &nbsp;  &nbsp;</p>  
</header>

<main class="d-flex justify-content-between flex-row mb-3 flex-lg-row">

    <div class="p-2 ">    
        <div class="sidebaror " > 
            <div class="content" >
                <a href="#" onclick="toggleSidebar()"><img src="/images/logo.png" alt="Botón de menú"></a>
            </div>
            <div class="sidebar" id="sidebar">
                <p>&nbsp; &nbsp;</p>
                <p>&nbsp; &nbsp;</p>
                <p>&nbsp; &nbsp;</p>
                <p>&nbsp; &nbsp;</p>
                <a href="#" onclick="checklist()"><img src="/images/listaicono.png" alt="Icono Checklist"></a>
                <a href="#" onclick="mascota()"><img src="/images/homeicono.png" alt="Icono Tienda"></a>
                <a href="#" onclick="cementerio()"><img src="/images/Tumba.png" alt="Icono Cementerio"></a>
            </div>
        </div>           

  </div>

  <div class="p-2 ">  
    
    
    <div class="punto d-flex align-items-center" >        
        <p style="margin: 3% 0;"></p>
        <!-- <img src="images/Monedas.png" alt="Moneda" class="moneda-image"> -->

        <div class="d-flex align-items-center">
            <p> &nbsp; &nbsp;</p>
            <p class="moneda-image">Puntos:</p>
            <p> &nbsp; &nbsp;</p>
            <p id="puntosTotales">00</p>
            <p> &nbsp; &nbsp;</p>
        </div>                
        
    </div>

    <div class="mascotabar" id="mascotabar">
        <a href="#" onclick="mascota()"><img src="/images/homeicono.png" alt="Icono de tienda"></a>
      </div>

      <div class="cerrar" id="cerrar">
        <a></a> <a></a>  <a></a> <a></a> <a></a> <a></a> <a></a> <a></a>
        <a href="#" onclick="cerrar()"><img src="/images/cerrar.png" alt="IconoCerrar"></a>
    </div>

        <div class="store">
            <div class="item">
                <img src="/images/1.1.png" alt="Producto 1">
                <img class="segunda-imagen" src="/images/1.2.png" alt="Producto 1-2" style="display: none">
                <p class="price">0</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(1)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/3.1.png" alt="Producto 2">
                <img class="segunda-imagen" src="/images/3.2.png" alt="Producto 2-2" style="display: none">
                <p class="price">10</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(2)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/2.1.png" alt="Producto 3">
                <img class="segunda-imagen" src="/images/2.2.png" alt="Producto 3-2" style="display: none">
                <p class="price">10</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(3)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/5.1.png" alt="Producto 4">
                <img class="segunda-imagen" src="/images/5.2.png" alt="Producto 4-2" style="display: none">
                <p class="price">15</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(4)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/6.1.png" alt="Producto 5">
                <img class="segunda-imagen" src="/images/6.2.png" alt="Producto 6-2" style="display: none">
                <p class="price">15</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(5)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/7.1.png" alt="Producto 6">
                <img class="segunda-imagen" src="/images/7.2.png" alt="Producto 7-2" style="display: none">
                <p class="price">35</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(6)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/4.1.png" alt="Producto 7">
                <img class="segunda-imagen" src="/images/4.2.png" alt="Producto 8-2" style="display: none">
                <p class="price">35</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(7)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/8.1.png" alt="Producto 8">
                <img class="segunda-imagen" src="/images/8.2.png" alt="Producto 9-2" style="display: none">
                <p class="price">35</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(8)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/9.1.png" alt="Producto 9">
                <img class="segunda-imagen" src="/images/9.2.png" alt="Producto 10-2" style="display: none">
                <p class="price">50</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(9)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/10.1.png" alt="Producto 10">
                <img class="segunda-imagen" src="/images/10.2.png" alt="Producto 11-2" style="display: none">
                <p class="price">50</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(10)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/11.1.png" alt="Producto 11">
                <img class="segunda-imagen" src="/images/11.2.png" alt="Producto 12-2" style="display: none">
                <p class="price">75</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(11)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/12.1.png" alt="Producto 12">
                <img class="segunda-imagen" src="/images/12.2.png" alt="Producto 13-2" style="display: none">
                <p class="price">75</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(12)">Comprar</button>
            </div>
            <div class="item">
                <img src="/images/13.1.png" alt="Producto 13">
                <img class="segunda-imagen" src="/images/13.2.png" alt="Producto 14-2" style="display: none">
                <p class="price">100</p>
                <input type="text" class="nuevaMascotaInput" placeholder="Nombre Mascota" required>
                <button class="buy-button" onclick="comprar(13)">Comprar</button>
            </div>
    </div>

  </div>



  <div class="p-2 "> 
   
  </div>

            
</main>

<footer>
  
</footer>

  <body>


</div>

  <script>
      function toggleSidebar() {
          var sidebar = document.getElementById('sidebar');
          if (sidebar.style.left === '0px') {
              sidebar.style.left = '-750px';
          } else {
              sidebar.style.left = '0px';
          }
      }
  </script>


<script>
    var userId = '<%= user.id %>';
       // var listaLocal = JSON.parse(localStorage.getItem('storeElements')) || [];
        window.onload = function () {
            // Obtener la lista local
            //var listaLocal = JSON.parse(localStorage.getItem('storeElements')) || [];

            fetch('/' + userId +'/mascotas')
            .then(response => response.json())
            .then(data => {
                itemStore = 0;
                data.forEach(function (element) {
                    if (element.index > itemStore) {
                        itemStore = element.index;
                    }
                });
                console.log("Lista mascotas: ", data);
            })
            .catch(error => console.error('Error al obtener la lista de tareas:', error));

            // Establecer itemStore en función del índice más alto en la lista local


         };

         fetch(`/${userId}/puntos`)
            .then(response => {
                if (!response.ok) {
                throw new Error(`Error de red: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('Datos de puntos:', data);
                if (data === null) {
                    data = 0;
                } else {
                    // Convertir a número si no es null
                    //data = parseInt(data, 10);

                   
                    if (data.length > 0) {
                        const idPuntos = data[0]._id;
                        console.log('ID de los puntos para el userId:', idPuntos);
                    } else {
                        if (data.length > 0) {
                        
                            fetch(`/${userId}/puntos`, {
                                method: 'POST', 
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                    body: JSON.stringify({
                                        userId: userId,
                                        puntosTotales: 0, 
                                    }),
                                })
                                .then(newResponse => {
                                    if (!newResponse.ok) {
                                         throw new Error(`Error al crear nuevos puntos: ${newResponse.status}`);
                                    }
                                        return newResponse.json();
                                })
                                .then(newData => {
                                        const newIdPuntos = newData._id;
                                        console.log('Se creó un nuevo conjunto de puntos. Nuevo ID:', newIdPuntos);

                                })
                                .catch(newError => {
                                        console.error('Error al crear nuevos puntos:', newError.message);

                                }); 
                            }
                    }  
                }
        
            })

            
        //localStorage.setItem('traspaso', false); //
        //var puntosTotalesGuardados = localStorage.getItem("puntosTotales"); ////

        fetch(`/${userId}/puntos`)
        .then(response => response.json())
        .then(data => {
            
            console.log('Lista de tareas:', data);
            if (data) {
            puntosTotales = data[0].puntosTotales;
            document.getElementById("puntosTotales").textContent = puntosTotales < 10 ? '0' + puntosTotales : puntosTotales;
            } else {
                puntosTotales = 0; 
            }
            
        })
        .catch(error => console.error('Error al obtener la lista de tareas:', error));




        var traspaso = true;
        //localStorage.setItem('traspaso', traspaso); //

        function comprar(item){
            //var puntosTotalesGuardados = localStorage.getItem("puntosTotales"); //
            fetch(`/${userId}/puntos`)
        .then(response => response.json())
        .then(puntosTotalesGuardados => {                  

            if (puntosTotalesGuardados) {
                puntosTotales = parseInt(puntosTotalesGuardados[0].puntosTotales, 10);
                document.getElementById("puntosTotales").textContent = puntosTotales < 10 ? '0' + puntosTotales : puntosTotales;
            } else {
                puntosTotales = 0;
            } 

            if (traspaso) {
                var precioElement = document.querySelector('.store .item:nth-child(' + item + ') .price');
                var precio = parseInt(precioElement.textContent, 10);

                if (puntosTotalesGuardados[0].puntosTotales >= precio) {
                    var nombreMascotaInput = document.querySelector('.store .item:nth-child(' + item + ') .nuevaMascotaInput');
                    var nombreMascota = nombreMascotaInput.value;
                    fetch('/' + userId +'/mascotas')
                    .then(response => response.json())
                    .then(data => {
       
                        var nombreRepetido = data.some(function (element) {
                        return element.nombre === nombreMascota;
                         });
                         
                    if (!nombreRepetido) {
                        var imagenMascotaDespierta = document.querySelector('.store .item:nth-child(' + item + ') img');
                        var imagenMascotaDormida = document.querySelector('.store .item:nth-child(' + item + ') .segunda-imagen');
                        var userId = '<%= user.id %>'
                        
                        var nuevoElemento = {
                            userId: userId,
                            imagenPrincipal: imagenMascotaDespierta.src,
                            segundaImagen: imagenMascotaDormida.src,
                            nombre: nombreMascota
                        };

                        //listaLocal.push(nuevoElemento);
                        let puntostotalesnuevo =  puntosTotalesGuardados[0].puntosTotales - precio;
                        console.log("Precios: " + precio);
                        console.log("Puntos totales nuevos: " + puntostotalesnuevo);

                        const idPuntos = puntosTotalesGuardados[0]._id;
                        if (!idPuntos) {
                                throw new Error('No se encontró un ID en los datos de puntos');
                        }

                        const dataToUpdate = {
                                userId: userId,
                                puntosTotales: puntostotalesnuevo ,
                        };
                                            
                        fetch(`/${userId}/puntos/${idPuntos}`, {
                                method: 'PUT',
                                headers: {
                                     'Content-Type': 'application/json',
                                },
                                body: JSON.stringify(dataToUpdate),
                        })
                        .then(response => {
                                if (!response.ok) {
                                    throw new Error(`Error del servidor: ${response.status} - ${response.statusText}`);
                               }
                                    return response.json();
                        })
                        .then(updatedData => {
                                    console.log('Response JSON:', updatedData);
                    
                        })
                        .catch(error => {
                                    console.error('Error al realizar la solicitud:', error);
                        });

                        //puntosTotalesGuardados -= precio;
                        //localStorage.setItem("puntosTotales", puntosTotalesGuardados); //

                        //localStorage.setItem('storeElements', JSON.stringify(listaLocal));
                        fetch('/' + userId +'/mascotas', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(nuevoElemento),
                            })
                            .then(response => response.json())
                            .then(data => {
                                // Manejar la respuesta recibida después de guardar la tarea
                                console.log('Mascota guardada:', data);
                                // Aquí puedes realizar cualquier otra operación después de guardar la tarea
                            })
                            .catch(error => console.error('Error al guardar la tarea:', error));

                        traspaso = false;
                        //localStorage.setItem('traspaso', traspaso);

                        ;
                        window.location.href = "/mascota/" + userId;
                    } else {
                        alert("El nombre de la mascota ya existe.");
                        // Aquí puedes mostrar un mensaje de error o tomar alguna acción adecuada.
                    }
                    })
                    .catch(error => console.error('Error al obtener la lista de tareas:', error));

                    // Comprobar si el nombre de la mascota ya existe en la lista local
                 

                }
            }
            })
            .catch(error => console.error('Error al obtener la lista de tareas:', error));


        }











</script>


<script>
    function checklist(){
        var userId = '<%= user.id %>';
        window.location.href = "/checklist/" + userId;

    }

    function index(){
        var userId = '<%= user.id %>';
        window.location.href = "/"  + userId;

    }

    function mascota(){
        var userId = '<%= user.id %>';
      window.location.href = "/mascota/" + userId;

    }

    function cementerio(){
        var userId = '<%= user.id %>';
      window.location.href = "/cementerio/" + userId;

    }

    function cerrar(){
        var userId = '<%= user.id %>';
        window.location.href = "/"  + userId;

    }


</script>

    <!--  <h1>Hello, world!</h1> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  </body>
</html>